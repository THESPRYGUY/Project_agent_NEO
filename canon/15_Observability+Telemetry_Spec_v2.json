{
  "meta": {
    "name": "15_Observability+Telemetry_Spec",
    "version": "v2.0.0",
    "owner": "SRE+CDO",
    "created_at": "2025-09-12T18:52:28Z"
  },
  "objective": "Privacy-aware telemetry schema, dashboards, and alerts for GEN2 agents.",
  "schema_keys": [
    "log_schema",
    "privacy_controls",
    "dashboards",
    "alerts"
  ],
  "token_budget": "â‰¤2000",
  "refs": {
    "global_instructions": "02_Global-Instructions_v2.json",
    "governance": "04_Governance+Risk-Register_v2.json",
    "safety_privacy": "05_Safety+Privacy_Guardrails_v2.json",
    "kpi_framework": "14_KPI+Evaluation-Framework_v2.json",
    "footprints_spec": "16_Reasoning-Footprints_Schema_v1.json"
  },
  "log_schema": {
    "task_event": [
      "timestamp",
      "agent_id",
      "task_id",
      "role",
      "archetype",
      "strategy_profile",
      "strategy_chain",
      "risk_tier",
      "tokens_input",
      "tokens_output",
      "latency_ms",
      "tool_calls",
      "cost_estimate_usd",
      "citations_count",
      "kpi_local_PRI",
      "kpi_local_HAL",
      "kpi_local_AUD",
      "strategy_metrics",
      "hitl_required",
      "hitl_actor",
      "status",
      "error_code"
    ],
    "rag_event": [
      "timestamp",
      "query_hash",
      "index_id",
      "hits",
      "latency_ms",
      "reranker_used",
      "passages_returned",
      "tokens_saved_cached"
    ],
    "reasoning_event": [
      "timestamp",
      "agent_id",
      "task_id",
      "footprint_id",
      "rti",
      "cord",
      "cona",
      "rfg",
      "reflection_loops",
      "debate_participants"
    ],
    "strategy_invocation": [
      "timestamp",
      "event_type",
      "schema_version",
      "agent_id",
      "run_id",
      "workflow_id",
      "workflow_run_id",
      "correlation_id",
      "task_id",
      "footprint_id",
      "scenario_id",
      "strategy_profile",
      "strategy_chain",
      "task_type",
      "risk_tier",
      "token_count",
      "tokens_input",
      "tokens_output",
      "latency_ms",
      "pri_score",
      "hal_score",
      "aud_score",
      "kpi_targets",
      "safety_flags",
      "hitl_required",
      "hitl_applied",
      "hitl_actor",
      "status"
    ]
  },
  "privacy_controls": {
    "no_content_logging": true,
    "pii_in_logs": "forbidden",
    "selectors_only": [
      "hash_ids",
      "counts",
      "scores"
    ],
    "jurisdiction_overrides_ref": "05_Safety+Privacy_Guardrails_v2.json#jurisdictional_rules"
  },
  "dashboards": {
    "exec_overview": [
      "ADR",
      "PRI",
      "HAL",
      "AUD",
      "LAT_p95",
      "CST",
      "INC",
      "industry_autofix_count",
      "industry_autofix_pct"
    ],
    "reliability_sre": [
      "pipeline_success_rate",
      "error_code_breakdown",
      "latency_p50_p95",
      "tool_error_rates"
    ],
    "reasoning_quality": [
      "RTI",
      "CORD",
      "CONA",
      "RFG",
      "reflection_loops",
      "debate_usage_rate"
    ],
    "compliance_view": [
      "AUD",
      "INC",
      "exceptions_open",
      "time_to_close_incidents",
      "industry_autofix_count",
      "industry_autofix_pct"
    ],
    "strategy_observability": [
      "avg_PRI_by_strategy_profile",
      "avg_HAL_by_strategy_profile",
      "avg_AUD_by_strategy_profile",
      "token_p95_by_strategy_chain",
      "latency_p95_by_strategy_profile",
      "hitl_activation_rate_by_profile"
    ]
  },
  "alerts": {
    "p1": [
      "pipeline_fail_rate>1%",
      "HAL>0.02",
      "AUD<0.90",
      "incident_S2_or_higher",
      "strategy_profile(regulatory_high_complex).hal_score>0.02_for_3_events"
    ],
    "p2": [
      "LAT_p95>15000ms",
      "PRI<0.95",
      "cost_budget_exceeded",
      "strategy_profile(governance_incident_high).hal_score>0.02_for_2_events",
      "strategy_chain(ReActPattern_v1+HallucinationCheck_v1).latency_ms_p95>20000",
      "token_count_outlier_by_strategy_profile>3sigma"
    ]
  },
  "storage": {
    "episodic_scope": "episodic:telemetry/*",
    "retention_days": 365,
    "export": [
      "csv",
      "parquet_optional"
    ]
  },
  "events": [
    {
      "name": "industry_autofix",
      "description": "NAICS autofill emitted when slot-19 canonical_industry+industry_source are auto-populated for an overlay pack.",
      "severity": "info",
      "metrics": [
        "industry_autofix_count",
        "industry_autofix_pct"
      ],
      "fields": [
        "overlay_pack_id",
        "persona_id",
        "naics_codes",
        "autofill_method",
        "autofill_outcome"
      ]
    },
    {
      "name": "strategy_invocation",
      "description": "Emitted whenever a workflow executes a strategy_chain with KPI deltas and HITL context. Each event MUST include footprint_id referencing the associated Reasoning Footprint entry and scenario_id when the run originates from an evaluation_set.",
      "event_type": "strategy_invocation",
      "schema_version": "1.1.0",
      "notes": [
        "Required fields: timestamp, event_type, schema_version, agent_id, run_id, workflow_id, workflow_run_id, correlation_id, task_id, footprint_id, scenario_id, strategy_profile, strategy_chain, task_type, risk_tier, kpi_targets, hitl_required, hitl_applied, status.",
        "Optional fields: token_count, tokens_input, tokens_output, latency_ms, pri_score, hal_score, aud_score, safety_flags, hitl_actor (MUST be null unless hitl_applied=true).",
        "KPI thresholds are tracked only inside kpi_targets (PRI_min, HAL_max, AUD_min).",
        "HITL semantics are enumerated in hitl_semantics and SHALL be followed for advisory_pending, completed_non_hitl, and completed_hitl events."
      ],
      "severity": "info",
      "metrics": [
        "strategy_invocations",
        "pri_score",
        "hal_score",
        "aud_score",
        "token_count",
        "latency_ms",
        "hitl_activation_rate"
      ],
      "fields": [
        "timestamp",
        "event_type",
        "schema_version",
        "agent_id",
        "run_id",
        "workflow_id",
        "workflow_run_id",
        "correlation_id",
        "task_id",
        "footprint_id",
        "scenario_id",
        "strategy_profile",
        "strategy_chain",
        "task_type",
        "risk_tier",
        "token_count",
        "tokens_input",
        "tokens_output",
        "latency_ms",
        "pri_score",
        "hal_score",
        "aud_score",
        "kpi_targets",
        "safety_flags",
        "hitl_required",
        "hitl_applied",
        "hitl_actor",
        "status"
      ],
      "required_fields": [
        "timestamp",
        "event_type",
        "schema_version",
        "agent_id",
        "run_id",
        "workflow_id",
        "workflow_run_id",
        "correlation_id",
        "task_id",
        "footprint_id",
        "scenario_id",
        "strategy_profile",
        "strategy_chain",
        "task_type",
        "risk_tier",
        "kpi_targets",
        "hitl_required",
        "hitl_applied",
        "status"
      ],
      "optional_fields": [
        "token_count",
        "tokens_input",
        "tokens_output",
        "latency_ms",
        "pri_score",
        "hal_score",
        "aud_score",
        "safety_flags",
        "hitl_actor"
      ],
      "kpi_targets": {
        "AUD_min": 0.9,
        "HAL_max": 0.02,
        "PRI_min": 0.95
      },
      "hitl_semantics": {
        "advisory_pending": {
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": true,
          "status": "hitl_pending"
        },
        "completed_hitl": {
          "hitl_actor": "regulatory_counsel",
          "hitl_applied": true,
          "hitl_required": true,
          "status": "completed"
        },
        "completed_non_hitl": {
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": false,
          "status": "completed"
        }
      },
      "examples": [
        {
          "agent_id": "agent.HCE_DRAC.GEN2",
          "aud_score": null,
          "correlation_id": "corr_drac_internal_advisory_2025Q4",
          "event_type": "strategy_invocation",
          "footprint_id": "fp_drac_internal_advisory_001",
          "hal_score": null,
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": true,
          "kpi_targets": {
            "AUD_min": 0.9,
            "HAL_max": 0.02,
            "PRI_min": 0.95
          },
          "latency_ms": null,
          "pri_score": null,
          "risk_tier": "medium",
          "run_id": "run_drac_internal_advisory",
          "safety_flags": {
            "disinfo_filtered": true,
            "persona_debate_used": false
          },
          "scenario_id": "drac_internal_advisory",
          "schema_version": "1.1.0",
          "status": "hitl_pending",
          "strategy_chain": [
            "ReActPattern_v1",
            "TariffCompare_v1",
            "HallucinationCheck_v1"
          ],
          "strategy_profile": "analysis_medium_internal",
          "task_id": "task_internal_advisory",
          "task_type": "internal_pricing_review",
          "timestamp": "2025-09-12T18:52:28Z",
          "token_count": null,
          "tokens_input": null,
          "tokens_output": null,
          "workflow_id": "wf_drac_internal_advisory",
          "workflow_run_id": "wf_run_drac_internal_advisory_01"
        },
        {
          "agent_id": "agent.HCE_DRAC.GEN2",
          "aud_score": 0.94,
          "correlation_id": "corr_drac_pricing_case_2025Q4",
          "event_type": "strategy_invocation",
          "footprint_id": "fp_drac_pricing_case_002",
          "hal_score": 0.009,
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": false,
          "kpi_targets": {
            "AUD_min": 0.9,
            "HAL_max": 0.02,
            "PRI_min": 0.95
          },
          "latency_ms": 5800,
          "pri_score": 0.96,
          "risk_tier": "medium",
          "run_id": "run_drac_pricing_case_2025Q4",
          "safety_flags": {
            "disinfo_filtered": true,
            "persona_debate_used": false,
            "pii_redaction": "selectors_only"
          },
          "scenario_id": "drac_pricing_case",
          "schema_version": "1.1.0",
          "status": "completed",
          "strategy_chain": [
            "CAPEConversation_v1",
            "TariffCompare_v1",
            "CertaintyReporter_v1",
            "HallucinationCheck_v1"
          ],
          "strategy_profile": "analysis_medium_internal",
          "task_id": "task_pricing_case_summary",
          "task_type": "pricing_update",
          "timestamp": "2025-10-14T15:11:00Z",
          "token_count": 1520,
          "tokens_input": 8800,
          "tokens_output": 1620,
          "workflow_id": "wf_drac_pricing_case",
          "workflow_run_id": "wf_run_drac_pricing_case_07"
        },
        {
          "agent_id": "agent.HCE_DRAC.GEN2",
          "aud_score": 0.95,
          "correlation_id": "corr_drac_board_brief_2025",
          "event_type": "strategy_invocation",
          "footprint_id": "fp_drac_board_brief_003",
          "hal_score": 0.008,
          "hitl_actor": "regulatory_counsel",
          "hitl_applied": true,
          "hitl_required": true,
          "kpi_targets": {
            "AUD_min": 0.9,
            "HAL_max": 0.02,
            "PRI_min": 0.95
          },
          "latency_ms": 6400,
          "pri_score": 0.97,
          "risk_tier": "medium",
          "run_id": "run_drac_board_brief_v1",
          "safety_flags": {
            "disinfo_filtered": true,
            "persona_debate_used": true
          },
          "scenario_id": "drac_board_brief",
          "schema_version": "1.1.0",
          "status": "completed",
          "strategy_chain": [
            "PlannerScaffold_v1",
            "ReActPattern_v1",
            "DisinfoFilter_v1",
            "HallucinationCheck_v1",
            "CertaintyReporter_v1"
          ],
          "strategy_profile": "analysis_medium_internal",
          "task_id": "task_board_brief",
          "task_type": "board_brief",
          "timestamp": "2025-10-20T09:41:00Z",
          "token_count": 1710,
          "tokens_input": 9100,
          "tokens_output": 1280,
          "workflow_id": "wf_drac_board_brief",
          "workflow_run_id": "wf_run_drac_board_brief_02"
        }
      ]
    }
  ],
  "strategy_invocation": [
    {
      "name": "strategy_invocation",
      "description": "Emitted whenever a workflow executes a strategy_chain with KPI deltas and HITL context. Each event MUST include footprint_id referencing the associated Reasoning Footprint entry and scenario_id when the run originates from an evaluation_set.",
      "event_type": "strategy_invocation",
      "schema_version": "1.1.0",
      "notes": [
        "Required fields: timestamp, event_type, schema_version, agent_id, run_id, workflow_id, workflow_run_id, correlation_id, task_id, footprint_id, scenario_id, strategy_profile, strategy_chain, task_type, risk_tier, kpi_targets, hitl_required, hitl_applied, status.",
        "Optional fields: token_count, tokens_input, tokens_output, latency_ms, pri_score, hal_score, aud_score, safety_flags, hitl_actor (MUST be null unless hitl_applied=true).",
        "KPI thresholds are tracked only inside kpi_targets (PRI_min, HAL_max, AUD_min).",
        "HITL semantics are enumerated in hitl_semantics and SHALL be followed for advisory_pending, completed_non_hitl, and completed_hitl events."
      ],
      "severity": "info",
      "metrics": [
        "strategy_invocations",
        "pri_score",
        "hal_score",
        "aud_score",
        "token_count",
        "latency_ms",
        "hitl_activation_rate"
      ],
      "fields": [
        "timestamp",
        "event_type",
        "schema_version",
        "agent_id",
        "run_id",
        "workflow_id",
        "workflow_run_id",
        "correlation_id",
        "task_id",
        "footprint_id",
        "scenario_id",
        "strategy_profile",
        "strategy_chain",
        "task_type",
        "risk_tier",
        "token_count",
        "tokens_input",
        "tokens_output",
        "latency_ms",
        "pri_score",
        "hal_score",
        "aud_score",
        "kpi_targets",
        "safety_flags",
        "hitl_required",
        "hitl_applied",
        "hitl_actor",
        "status"
      ],
      "required_fields": [
        "timestamp",
        "event_type",
        "schema_version",
        "agent_id",
        "run_id",
        "workflow_id",
        "workflow_run_id",
        "correlation_id",
        "task_id",
        "footprint_id",
        "scenario_id",
        "strategy_profile",
        "strategy_chain",
        "task_type",
        "risk_tier",
        "kpi_targets",
        "hitl_required",
        "hitl_applied",
        "status"
      ],
      "optional_fields": [
        "token_count",
        "tokens_input",
        "tokens_output",
        "latency_ms",
        "pri_score",
        "hal_score",
        "aud_score",
        "safety_flags",
        "hitl_actor"
      ],
      "kpi_targets": {
        "AUD_min": 0.9,
        "HAL_max": 0.02,
        "PRI_min": 0.95
      },
      "hitl_semantics": {
        "advisory_pending": {
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": true,
          "status": "hitl_pending"
        },
        "completed_hitl": {
          "hitl_actor": "regulatory_counsel",
          "hitl_applied": true,
          "hitl_required": true,
          "status": "completed"
        },
        "completed_non_hitl": {
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": false,
          "status": "completed"
        }
      },
      "examples": [
        {
          "agent_id": "agent.HCE_DRAC.GEN2",
          "aud_score": null,
          "correlation_id": "corr_drac_internal_advisory_2025Q4",
          "event_type": "strategy_invocation",
          "footprint_id": "fp_drac_internal_advisory_001",
          "hal_score": null,
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": true,
          "kpi_targets": {
            "AUD_min": 0.9,
            "HAL_max": 0.02,
            "PRI_min": 0.95
          },
          "latency_ms": null,
          "pri_score": null,
          "risk_tier": "medium",
          "run_id": "run_drac_internal_advisory",
          "safety_flags": {
            "disinfo_filtered": true,
            "persona_debate_used": false
          },
          "scenario_id": "drac_internal_advisory",
          "schema_version": "1.1.0",
          "status": "hitl_pending",
          "strategy_chain": [
            "ReActPattern_v1",
            "TariffCompare_v1",
            "HallucinationCheck_v1"
          ],
          "strategy_profile": "analysis_medium_internal",
          "task_id": "task_internal_advisory",
          "task_type": "internal_pricing_review",
          "timestamp": "2025-09-12T18:52:28Z",
          "token_count": null,
          "tokens_input": null,
          "tokens_output": null,
          "workflow_id": "wf_drac_internal_advisory",
          "workflow_run_id": "wf_run_drac_internal_advisory_01"
        },
        {
          "agent_id": "agent.HCE_DRAC.GEN2",
          "aud_score": 0.94,
          "correlation_id": "corr_drac_pricing_case_2025Q4",
          "event_type": "strategy_invocation",
          "footprint_id": "fp_drac_pricing_case_002",
          "hal_score": 0.009,
          "hitl_actor": null,
          "hitl_applied": false,
          "hitl_required": false,
          "kpi_targets": {
            "AUD_min": 0.9,
            "HAL_max": 0.02,
            "PRI_min": 0.95
          },
          "latency_ms": 5800,
          "pri_score": 0.96,
          "risk_tier": "medium",
          "run_id": "run_drac_pricing_case_2025Q4",
          "safety_flags": {
            "disinfo_filtered": true,
            "persona_debate_used": false,
            "pii_redaction": "selectors_only"
          },
          "scenario_id": "drac_pricing_case",
          "schema_version": "1.1.0",
          "status": "completed",
          "strategy_chain": [
            "CAPEConversation_v1",
            "TariffCompare_v1",
            "CertaintyReporter_v1",
            "HallucinationCheck_v1"
          ],
          "strategy_profile": "analysis_medium_internal",
          "task_id": "task_pricing_case_summary",
          "task_type": "pricing_update",
          "timestamp": "2025-10-14T15:11:00Z",
          "token_count": 1520,
          "tokens_input": 8800,
          "tokens_output": 1620,
          "workflow_id": "wf_drac_pricing_case",
          "workflow_run_id": "wf_run_drac_pricing_case_07"
        },
        {
          "agent_id": "agent.HCE_DRAC.GEN2",
          "aud_score": 0.95,
          "correlation_id": "corr_drac_board_brief_2025",
          "event_type": "strategy_invocation",
          "footprint_id": "fp_drac_board_brief_003",
          "hal_score": 0.008,
          "hitl_actor": "regulatory_counsel",
          "hitl_applied": true,
          "hitl_required": true,
          "kpi_targets": {
            "AUD_min": 0.9,
            "HAL_max": 0.02,
            "PRI_min": 0.95
          },
          "latency_ms": 6400,
          "pri_score": 0.97,
          "risk_tier": "medium",
          "run_id": "run_drac_board_brief_v1",
          "safety_flags": {
            "disinfo_filtered": true,
            "persona_debate_used": true
          },
          "scenario_id": "drac_board_brief",
          "schema_version": "1.1.0",
          "status": "completed",
          "strategy_chain": [
            "PlannerScaffold_v1",
            "ReActPattern_v1",
            "DisinfoFilter_v1",
            "HallucinationCheck_v1",
            "CertaintyReporter_v1"
          ],
          "strategy_profile": "analysis_medium_internal",
          "task_id": "task_board_brief",
          "task_type": "board_brief",
          "timestamp": "2025-10-20T09:41:00Z",
          "token_count": 1710,
          "tokens_input": 9100,
          "tokens_output": 1280,
          "workflow_id": "wf_drac_board_brief",
          "workflow_run_id": "wf_run_drac_board_brief_02"
        }
      ]
    }
  ]
}