*** Begin Patch
*** Update File: docs/API.md
@@
-## POST /build
-Builds the canonical 20-pack repo from an intake JSON and writes artifacts to `NEO_REPO_OUTDIR`.
+## POST /build
+Builds the canonical 20-pack repo and writes the single source of truth (SoT) under
+`_generated/<AGENT_ID>/<UTC_TS>/`.
@@
-## GET /last-build
-Returns a compact JSON summary of the last successful build, including parity flags and outdir.
+## GET /last-build
+Returns a compact JSON pointer to the last successful build.
+
+Schema v2.1.1 (example):
+
+```
+{ "schema_version":"2.1.1", "agent_id":"…", "outdir":"…/_generated/<AGENT_ID>/<UTC_TS>", "files":20, "ts":"…Z", "zip_hash":"<sha256>" }
+```
@@
-## GET /download/zip
-Streams the current 20-file pack as a ZIP (strict parity enforced by CI).
+## GET /download/zip
+Streams the current 20-file pack as a ZIP. When `?outdir=` is omitted, the server
+uses the `outdir` from `/last-build`.
@@
-## Parity & Rate/Size Notes
+## Parity & Rate/Size Notes
@@
- - CI artifacts (per build): `INTEGRITY_REPORT.json`, `contract_report.json`, `repo.zip`.
+ - CI artifacts (per build): `INTEGRITY_REPORT.json`, `contract_report.json`, `repo.zip`.
+
+LEGACY NOTE
+
+`/api/agent/generate` is considered legacy. Prefer POST `/build` for SoT-aware flows.
+Future versions may support `?sot=true` to align the legacy endpoint with SoT behavior.
*** End Patch
